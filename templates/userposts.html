{% extends "base.html" %}
{% block title %}My Posts{% endblock %}
{% block content %}


<div id="listingResults" class="listing-container"></div>

<script src="{{ url_for('static', filename='script.js') }}"></script>

<div class="listing-container container mt-5">
<!-- Listings Section -->
<div class="listing-content">
    <div class="custom-grid">
        {% for listing in listings %}
        <div class="card">
            {% set image_path = 'uploads/default.png' if not listing.images else 'uploads/' + listing.images.split(',')[0].strip() %}
         
            <!-- Image wrapped in a link to show.html -->
            <a href="{{ url_for('views.show', listing_id=listing.id) }}">
                <img src="{{ url_for('static', filename=image_path) }}" class="card-img-top" alt="Listing Image">
            </a>

            <i class="position-absolute top-0 start-0 m-2 ratingValue text-gold fw-bold" data-listing-id="{{ listing.id }}"></i>

            <div class="card-body">
                
                <p class="text-danger fw-bold">
                    KES {{ "{:,.0f}".format(listing.price) }}
                </p>
                <form action="{{ url_for('views.delete_post', listing_id=listing.id) }}" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure you want to delete this listing?');">Delete</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
</div>
<style>
    /* Layout Improvements */
    .listing-container {
        max-width: 12000px; /* Limits the width for a cleaner display */
        margin: auto;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        background-color: #fff;
        padding: 0px !important;

    }

    /* Listings Section */
    .listing-content {
        flex: 2;
        width: 100%;    
    }

    .custom-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
        padding: 0px !important;
    }

    .card {
        transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        border: none;
    }

    .card:hover {
        transform: scale(1.05);
        box-shadow: none;
    }

    .card-img-top {
        height: 150px;
        object-fit: cover;
        border-radius: 5px;
    }
    
    /* Mobile Adjustments */
    @media (max-width: 768px) {

        .listing-container {
            flex-direction: column;
            align-items: center;
        }
        .custom-grid {
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        }

        .card-img-top {
            height: 140px;
        }
    }

    /* Clickable Image */
    .small-clickable-image {
        cursor: pointer;
        border-radius: 5px;
        transition: transform 0.2s;
    }

    .small-clickable-image:hover {
        transform: scale(1.05);
    }

    .custom-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* Default Layout */
        gap: 5px !important; /* Gap between cards */
    }
    
    /* Adjust grid for small screens (3 columns) */
    @media (max-width: 720px) {
        .custom-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }
    
    /* Adjust grid for large screens (6 columns) */
    @media (min-width: 1024px) {
        .custom-grid {
            grid-template-columns: repeat(8, 1fr);
            padding: 0px !important;
        }
    }

</style>

{% endblock %}
